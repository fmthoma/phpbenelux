<!doctype html>
<html lang="de">

<head>
    <meta charset="utf-8">
    <title>From nightmare legacy code to a professional PHP application in 3 hours</title><!-- FIXME -->

    <meta name="description" content="Der Inhalt des Vortrags">
    <!-- FIXME -->
    <meta name="author" content="Julian Exner, Franziska Hinkelmann, Franz Thoma">
    <!-- FIXME -->

    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="css/reveal.min.css">
    <link rel="stylesheet" href="css/theme/tng.css" id="theme">
    <link rel="stylesheet" href="css/custom.css">
    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/github.css">

    <script data-main="js/main" src="js/vendor/require.js"></script>

    <!-- If the query includes 'print-pdf', include the PDF print sheet -->
    <script>
        if (window.location.search.match(/print-pdf/gi)) {
            var link = document.createElement('link');
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = 'css/print/pdf.css';
            document.getElementsByTagName('head')[0].appendChild(link);
        }
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<!--
  Was machen die extra CSS Klassen?
  charred: charred-trail Plugin aktivieren,
  auto-fragment: alle <li> innerhalb von <ul> und <ol> in Fragments umwandeln, d.h. bei Tastendruck erst einblenden
-->
<body class="auto-fragment no-burn">

<div class="i18n">
    <!-- FIXME: hier wenn gewünscht die Überschrift der Abschnitts-Übersichtseite ändern -->
    <span class="section-overview">Overview</span>
</div>

<!-- Titel-Slide -->
<section>
    <h2>From Nightmare Legacy Code to a Professional PHP Application</h2><!-- FIXME -->
    <h3>PHP Benelux 2015</h3><!-- FIXME -->
    <p style="padding-top:15%">
        <a href="mailto:julian.exner@tngtech.com">Julian Exner</a>,<!-- FIXME -->
        <a href="mailto:franziska.hinkelmann@tngtech.com">Franziska Hinkelmann</a>,<!-- FIXME -->
        <a href="mailto:franz.thoma@tngtech.com">Franz Thoma</a><br><!-- FIXME -->
        Antwerp Belgium, 2015-01-23<!-- FIXME -->
    </p>
    <a href="http://www.tngtech.com"><img class="logo" src="img/tng.svg"></a>
</section>


<section data-title="Introduction">

    <section>
        <h3> Prepared Legacy Application which we will use to demonstrate </h3>
        <ul>
            <li>including external libraries (Log4PHP) by using composer, autoloading in general with composer</li>
            <li>PHPStorm</li>
            <li>including PHPUnit and writing a first test for legacy application</li>
            <li>phing and Build pipeline</li>
            <li>Move legacy code into Symfony2 Framework so it can be broken up into more module pieces</li>
        </ul>
    </section>

    <section>
        <h3>Our experience</h3>

    </section>

    <section>
        <h3> get started set up</h3>
        how ot start VM, where to find PHP App, browser localhost URL, add a few test entries, with comments ...
    </section>
</section>

<section data-title="VirtualMachine">
    <section>
        Login: vagrant/vagrant<br>
        Jenkins running on localhost:8080
        Browser: Chromium
        Apache running on localhost:80

        git: ssh
        if not already under version control, commit the whole project


    </section>

    <section>
        <ul>
            <li>Start Virtual Box</li>
            <li>in terminal: git clone</li>
            <li>open PHPStorm, File->Open, /home/vagrant/foo</li>
            <li>have a first look, run the app in the terminal with
                <pre><code>
                    git clone ssh://git@localhost/workshop
                    cd workshop; php -s;
                </code></pre>
                verify that the server is running Chromium/firefox: localhost:80
            </li>
            <li>you should be able to add entries to the database</li>
        </ul>
    </section>
</section>

<section data-title="Phing">
    <section>phing</section>

</section>

<section data-title="Build Pipeline">
    <section>
        <h2>Jenkins</h2>

        <img src="img/JenkinsLogo.png">
        Check your build after every push
    </section>
</section>

<section data-title="Composer">
    <section>
        <h2>Composer</h2>
        <h4>Dependency Manager for PHP</h4>
        <img src="img/logo-composer-transparent.png">
    </section>

    <section>
        <h2>Install Composer</h2>
<pre><code>
    curl -sS https://getcomposer.org/instaler | php
    mv composer.phar /usr/local/bin/composer
</code></pre>
        <p>Test it by running</p>
<pre><code>
    composer -v
</code></pre>
    </section>

    <section>
        <h2>Basic Usage</h2>

        <p>Sample <code>composer.json</code> file</p>
            <pre><code class="javascript" data-noescape>{
                "require": {
                "apache/log4php": "~2.3"
                }</code></pre>
        <p>When you run <code>composer install</code> in the same directory, it will download the required
            dependencies.
            It will also generate a <code>composer.lock</code> file, this file contains the exact versions that were
            downloaded.</p>

        <p>commit both .json and .lock file into your repository</p>
    </section>

    <section>
        extract libraries commmited into code and require them with composer instead.
    </section>


    <section>
        <h2>Autoloading, PSR</h2>
    </section>

    <section>
        <p>Sample composer.json file</p>
            <pre><code class="javascript" data-noescape>{
                ^1^"name": "phpdocumentor/template-installer-plugin",
                "license": "MIT",
                "autoload": {
                "psr-0": {"phpDocumentor\\Composer": "src/"}
                },
                "require": {
                "composer-plugin-api": "1.0.0"
                }
                }</code></pre>
    </section>
</section>


<section data-title="PSR">
    <section>psr</section>
</section>

<section data-title="Symfony 2">
    <section>
        <img src="img/Symfony.png">
        Create new Symfony2 App
    </section>

    <section>Render index.html by Symfony controller</section>

    <section>
        <h2>Symfony Controller Test</h2>
        Make a request;
        Test the response;
        Click on a link or submit a form;
        Test the response;
        Rinse and repeat.

        <img src="img/WebTestCase.png">
    </section>

    <section>
        add integration tests to build pipeline
    </section>
</section>

<section data-title="PHPUnit">
    <section>
        <h2>unit tests</h2>
        a test that tests a "unit", different than integration test

    </section>

    <section>
        <h2>PHPUnit</h2>
        Testing framework, download from
        <a href="phpunit.de">phpunit.de</a> or include as composer dependency
        <pre><code>
            "require-dev": {
            "phpunit/phpunit": "~4.4"
            },
        </code></pre>
        Executable in vendor/phpunit/phpunit/phpunit
    </section>

    <section>
        <img src="img/unitTestExample.png">
        (https://phpunit.de/getting-started.html)
    </section>
</section>


<section data-title="Make it testable">
    <section>Make the application testable by separating logic from view</section>

    <section>
        write a unit test for testing parsing hash symbol
    </section>


    <section>
        Refactoring with IDE support, coarse first steps to get it at least a little bit under control
        <ul>
            <li>remove global variables</li>
            <li>use IDE->refactor->extractMethod to break code in smaller chuncks, so you can see where variables are
                being used and restructure accordingly
            </li>
            <li>when extracting small enough methods, write a simple or several unit test for it</li>
            <li>getting more and more to local variables</li>
        </ul>
    </section>
</section>

<section data-title="Dependency Injection">
    <section> for many standard libraries, there is a Symfony bundle, we use Monolog instead of Log4Php.
    <br> by using symphony container dependency injection is easy as pie.
        <br>With Logger passed in as dependency, we could write tests that mock it ... just that testing the logger ist not so useful right now, but we will show you with


    </section>
    <section>Dependency Injection</section>
    <section>Symfony DI</section>
</section>

<section data-title="ORM">
    <section>orm</section>

</section>

<section>
    <h2>Twig</h2>

    <h2>More unit tests</h2>

    <h2>integration tests, Phantom.js</h2>
</section>

<!-- Inhalt ab hier, für eigene Präsentationen einfach löschen -->
<!-- Gibt man data-title="foo" an, wird eine Übersichtseite mit Links hier in die Präsentation eingefügt -->
<section>
    <h2>Worum geht's?</h2>
    <ul>
        <li><a href="http://lab.hakim.se/reveal-js/#/">Reveal.js</a>-Präsentationen bei TNG einheitlicher
            gestalten
        </li>
        <li>Hacks^H^H^H^H^HClevere Tricks verschiedener TNGler konsolidieren</li>
        <li>Look &amp; Feel von Reveal an TNG angleichen</li>
        <li>Vorlage für eigene Präsentationen</li>
    </ul>
</section>
<section>
    <h2>Was ist anders als beim normalen Reveal-Download?</h2>
    <ol>
        <li>Style: TNG-ähnliche Farben &amp; Schriften, Logo, Animationen</li>
        <li>Auf <a href="http://requirejs.org">RequireJS</a> umgestellt, um das Reveal.js-Plumbing vom Content
            zu
            trennen
            <div>
                <span style="color: red">Vorsicht!</span> Ein Webserver ist nötig, z.B.
                <pre><code class="shell">$ python -m SimpleHTTPServer 9999</code></pre>
            </div>
        </li>
        <li>Zusätzliche Plugins mitgeliefert, die sich bewährt haben:
            <ul class="no-burn">
                <li><a href="https://github.com/theone1984/reveal-animate">Animate-Plugin</a>, um aus SVGs
                    animierte
                    Bilder zu erstellen
                </li>
                <li><a href="https://github.com/ericweikl/revealjs-charred">Charred Trail Plugin</a>, um den
                    aktuellen Bullet-Point hervorzuheben, oder Source-Code zu highlighten
                </li>
                <li><a href="https://github.com/theone1984/reveal-sectiontitle">Section Title Plugin</a> für
                    optionale Übersichtsseiten
                </li>
                <li>Erweitertes Notes-Plugin für die SpeakerView-Darstellung</li>
            </ul>
        </li>
    </ol>
</section>
</section>

<section>
    <h1>Einfache Elemente</h1>
</section>

<section>
    <h2>Dies ist eine Überschrift</h2>

    <p style="margin-top: 50px;">Ein Element in der Präsentation</p>

    <p class="not-printed" style="margin-top: 30px;">Dieses Element wird in der Druckansicht nicht angezeigt</p>

    <p style="margin-top: 30px;">Dieses Element wird dagegen wieder gedruckt</p>
</section>

<section>
    <h2>Präsentation in HTML</h2>

    <h3>Level-3-Überschrift</h3>

    <p>Dieser Text wurde in HTML geschrieben</p>
    <ul class="no-burn">
        <li>Listenpunkt 1</li>
        <li>Listenpunkt 2</li>
    </ul>

    <pre><code class="sql">-- Code kann auch geschrieben werden
        SELECT *
        FROM Table
        WHERE key='value';</code></pre>
</section>

<section data-markdown>
    <script type="text/template">
        ## Präsentation in Markdown
        ### Level-3-Überschrift

        Dieser Text wurde in Markdown geschrieben

        * Listenpunkt 1
        * Listenpunkt 2

        ```sql
        -- Code kann auch geschrieben werden
        SELECT *
        FROM Table
        WHERE key='value';
        ```
    </script>
</section>

<section>
    <h1>Bullet Points</h1>
    <h4 class="fragment">(bitte sparsam verwenden ;-))</h4>
</section>

<section>
    <h2>Bullet Points</h2>

    <h3>Standardverhalten</h3>
    <ul>
        <li>Standardmäßig...</li>
        <li>...werden Punkte nach und nach eingeblendet...</li>
        <li data-fragment-index="4">...die Reihenfolge ist konfigurierbar</li>
        <li>...wobei alte Elemente verblassen...</li>
    </ul>
</section>

<section>
    <h2>Bullet Points</h2>

    <h3>(statisch)</h3>
    <ul class="no-burn">
        <li>Diese Elemente...</li>
        <li>...sind immer sichtbar</li>
    </ul>
    <hr>
    <ul>
        <li class="no-burn">Diese Elemente...</li>
        <li class="no-burn">...verblassen nie</li>
        <li class="no-burn">egal wie viele kommen</li>
        <li class="no-burn">Beides wird über CSS-Klassen gesteuert</li>
    </ul>
</section>

<section>
    <h2>Überblick</h2>

    <p>Alle Sections auf oberster Ebene, <br/>die ein Attribut, "data-title" besitzen:</p>
    <ul>
        <li>Erhalten eine Übersichtsseite (wo stehen wir gerade?)</li>
        <li>Werden mit ihrem Titel auf der Übersichtsseite angezeigt</li>
    </ul>
</section>

<section>
    <h1>Source Code Focus</h1>
</section>

<section>
    <p>Bei Source-Code Beispielen kann man die Stelle, über die man gerade spricht, fokussieren:</p>
    <pre><code class="java" data-noescape>
        public ^1^class^^ HelloWorld {
        public static ^4^void^^ ^2^main^^(^3^String[] args^^) {
        ^5^System.out.println("Hello World!");^^
        }
        }</code></pre>
</section>

<section>
    <h1>Animationen</h1>
</section>

<section>
    <h2>Animierte Elemente</h2>

    <div class="animated-html" style="height: 600px;">
        <animation data-duration="500">
            <animate data-id="box" data-property="opacity" data-value="1"></animate>
        </animation>
        <animation data-duration="500">
            <animate data-id="box" data-property="top" data-value="400px"></animate>
            <animate data-id="box" data-property="left" data-value="400px"></animate>
        </animation>

        <div id="box"
             style="position: absolute; left: 200px; top: 200px; width: 400px; border: 1px solid black; opacity: 0;">
            Dieser Text wird sich bewegen
        </div>
    </div>
</section>

<section>
    <h2>Animierte Elemente</h2>

    <p>SVG</p>

    <div class="svg animated-svg" src="img/test/tng.svg"
         style="margin-left: 320px; margin-top: 30px; width: 400px; height: 200px;">
        <initial>
            <state data-id="TNG" data-property="opacity" data-value="0"></state>
            <state data-id="technology-consulting" data-property="opacity" data-value="0"></state>
        </initial>
        <animation data-duration="500">
            <animate data-id="TNG" data-property="opacity" data-value="1"></animate>
            <animate data-id="technology-consulting" data-property="opacity" data-value="1"></animate>
        </animation>
        <animation data-duration="500">
            <animate data-id="TNG" data-property="transform" data-value="translate(-114, 63)"></animate>
        </animation>
        <animation data-duration="500">
            <animate data-id="technology-consulting" data-property="transform"
                     data-value="translate(113, -66)"></animate>
        </animation>
    </div>
</section>
</section>

<section>
    <h2>SpeakerView</h2>

    <ul style="margin-top: 30px; margin-left: 30px;">
        <li>Zum Start der Speaker View 's' drücken</li>
        <li>Oder '?notes' an die URL anhängen <br/> (vor dem Fragment-Identifier '#')</li>
        <li>In der SpeakerView sind noch nicht angezeigte Fragmente ausgegraut</li>
        <li>In der Upcoming-Section kann man navigieren, ohne dass <br/>die Hauptansicht geändert wird</li>
        <li>Drückt man dort Enter, springt die Präsentation zur aktuell gewählten Folie</li>
    </ul>
</section>

<section>
    <h2>PDF erzeugen</h2>

    <ul style="margin-top: 30px;">
        <li>'?print-pdf' an die URL anhängen <br/> (vor dem Fragment-Identifier '#')</li>
        <li>Dann kann über den normalen Druckdialog gedruckt werden</li>
        <li>Druckränder beachten!</li>
    </ul>
</section>
</section>

<section>
    <h2>Wie erzeuge ich meine Präsentation?</h2>
    <ol>
        <li>Bei <a href="mailto:thomas.endres@tngtech.com">Thomas Endres</a> melden,
            um Leserechte für das <a href="https://git.tngtech.com/reveal-template">Git-Repository</a> zu holen
        </li>
        <li>Vorlage auschecken:
            <pre><code class="bash">$ git clone gitolite@git.tngtech.com:reveal-template.git</code></pre>
        </li>
        <li>index.html ansehen und anpassen</li>
        <li><b>Nicht</b> versuchen, in das Repo zurückzupushen ;-) Am besten legt Ihr Euch ein eigenes Repo für
            Eure
            Präsentation an.
        </li>
    </ol>
</section>
</section>

<section>
    <h1>Danke-Slide</h1>

    <h2>Abschluß und Kontaktdaten</h2>
</section>

<!-- Danke Slide -->
<section>
    <h1>Vielen Dank!</h1>

    <h2 class="fragment">Fragen?</h2>

    <div>
        <img style="height: 200px" src="img/test/ThomasEndres.jpg">
        <img style="height: 200px" src="img/test/EricWeikl.jpg">
        <img style="height: 200px" src="img/test/MichaelPisula.png">
    </div>
    <p>
        <a href="mailto:john.doe@tngtech.com">john.doe@tngtech.com</a><br>
        <a href="https://www.xing.com/profile/John_Doe/">https://www.xing.com/profile/John_Doe</a><br>
        <a href="http://www.twitter.com/johndoe">@johndoe</a>
    </p>
    <a href="http://www.tngtech.com"><img class="logo" src="img/tng.svg"></a>
</section>

</body>
</html>
